<!doctype html>
<html>
<head>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta charset="utf-8">
    <title>Demo</title>
    <link rel="stylesheet" type="text/css" href="style/css/reset.css"/>
    <link rel="stylesheet" type="text/css" href="style/css/main.css"/>
    <link rel="stylesheet" type="text/css" href="style/css/transition.min.css"/>

    <link rel="stylesheet" type="text/css" href="http://at.alicdn.com/t/font_1420300224_9331315.css"/>

    <script type="text/javascript" src="style/js/zepto.js"></script>
    <script type="text/javascript" src="style/js/AV.push.js"></script>
    <script type="text/javascript" src="style/js/transition.min.js"></script>
</head>
<body class="page-signup">
    <div id="page-username" data-role="page">
        <div class="content-wrap">
            <div class="content-inner">
                <input type="text" id="checkUserName" placeholder="用户名" value="kitty"/>
                <a data-validator="checkUserName" transition="slide" class="next-button" href="#page-mobile">Next</a>
            </div>
        </div>
    </div>
    <div id="page-avatar" data-role="page" data-title="用户头像">
        <div class="content-wrap">
            <div class="content-inner">
                <input type="file" id="avatar" placeholder="头像"/>
                <a data-validator="avatar" transition="slide" class="next-button" href="#page-mobile">Next</a>
            </div>
        </div>
    </div>
    <div id="page-mobile" data-role="page" data-title="手机号">
        <div class="content-wrap">
            <div class="content-inner">
                <input type="text" id="mobile" placeholder="手机号"/>
                <input type="password" id="password" placeholder="密码"/>
                <a data-validator="mobile" transition="slide" class="next-button" href="#page-verification">Next</a>
            </div>
        </div>
    </div>
    <div id="page-verification" data-role="page" data-title="手机验证">
        <div class="content-wrap">
            <div class="content-inner">
                <input type="text" id="verification-code" placeholder="验证码"/>
                <a data-validator="verification-code" transition="slide" class="next-button" href="#page-signup-successful">Next</a>
            </div>
        </div>
    </div>
    <div id="page-signup-successful" data-role="page" data-title="注册成功">
        <div class="content-wrap">
            <div class="content-inner">
                <h1>Successful!</h1>
                <button class="next-button">Next</button>
            </div>
        </div>
    </div>
    <script>
        // 最简的示例代码，请换成自己的 appId 和 appKey
        var appId = 'nddk6udki7vg06j1w2gqli72t0q64hxivnf2zvxdzm8sef55';
        var appKey = 'qke60ogn5d7vpr4k3he9ykm9sibq6buifwxxrjkl2qytm480';


        $('[data-role="page"] [data-validator]').on('click',function( e ){
            var elm = $(e.target),
                type = elm.data('validator'),
                data = {};

            data[type] = $('#'+type).val();

            $.ajax({
                type: 'POST',
                url: 'https://leancloud.cn:443/1.1/functions/'+type,
                data: JSON.stringify(data),
                contentType: 'application/json',
                headers : {
                    'X-AVOSCloud-Application-Id' : 'nddk6udki7vg06j1w2gqli72t0q64hxivnf2zvxdzm8sef55',
                    'X-AVOSCloud-Application-Key' : 'qke60ogn5d7vpr4k3he9ykm9sibq6buifwxxrjkl2qytm480'
                },
                success: function(remoteData){
                    // Supposing this JSON payload was received:
                    //   {"project": {"id": 42, "html": "<div>..." }}
                    // append the HTML to context object.
                    if( remoteData && remoteData.result.code === 200 && remoteData.result.results ){
                        var href = elm.attr('href');
                        if( href.indexOf('#') === 0 ){
                            location.hash = href;
                        }else{
                            location.href = href;
                        }
                    }
                },
                error: function(xhr, type){
                    alert('Ajax error!')
                }
            });

            e.stopPropagation();
            return false;
        });
        $('#page-signup-successful button').on('click',function(e){
            location.href = 'index.html';
        });
    </script>
</body>
</html>